import openpyxl
import uuid

file_path = 'Database.xlsx'
wb = openpyxl.load_workbook(file_path)

# --- DAILY SHEET UPDATE ---
ws_daily = wb['行事']
# Columns: A:ID, B:Date, C:Time, D:Content, E:Note, F:EndDate, G:Order, H:ScheduleType
# 1-based indexing for append

daily_events = [
    ("2025/12/01", "", "高教研書道部会公開授業研究（午後）", "", "2025/12/01", None),
    ("2025/12/02", "", "評点入力完了（２年のみ, 16:40）、第２回入試準備委員会（3限、大会議室）、職員研修（15:45-16:40）", "短縮・清掃カット", "2025/12/02", "短縮校時"),
    ("2025/12/03", "4限", "運委", "", "2025/12/03", None),
    ("2025/12/04", "", "評点入力完了（1,3年, 16:40）、拡大学年会議（２年）", "短縮・2年清掃カット", "2025/12/04", "短縮校時"),
    ("2025/12/05", "", "HRA２年（修学旅行結団式）、第2回学校生活アンケート、いじめ防止・いじめ対策委員会（応接室、15:20-16:30）", "", "2025/12/05", None),
    ("2025/12/06", "", "修学旅行①（2年）", "", "2025/12/06", None),
    ("2025/12/07", "", "修学旅行②（2年）", "", "2025/12/07", None),
    ("2025/12/08", "", "修学旅行③（2年）", "", "2025/12/08", None),
    ("2025/12/09", "", "修学旅行④（2年）", "", "2025/12/09", None),
    ("2025/12/10", "", "修学旅行⑤（2年）", "", "2025/12/10", None),
    ("2025/12/11", "", "1年クラスマッチ、（2年振替休業）、拡大学年会議（1,3年）（15:45-16:35）", "短縮・清掃カット", "2025/12/11", "短縮校時"),
    ("2025/12/12", "", "HRA１年（僕らの未来会議参加、パトリア14:00-15:30）、（2年振替休業）", "1年のみ清掃カット", "2025/12/12", None),
    ("2025/12/13", "", "GTEC（1年、自宅受験）", "", "2025/12/13", None),
    ("2025/12/14", "", "GTEC（1年、自宅受験）", "", "2025/12/14", None),
    ("2025/12/15", "", "【SSC】APU留学生との交流会②（2年SS/5〜6限）、運営委員会（７限）", "", "2025/12/15", None),
    ("2025/12/16", "", "海外研修（台湾）①", "", "2025/12/16", None),
    ("2025/12/17", "", "海外研修（台湾）②、遠隔配信視察（他県より、5,6限）", "", "2025/12/17", None),
    ("2025/12/18", "", "海外研修（台湾）③", "", "2025/12/18", None),
    ("2025/12/19", "", "HRA（２学期の振り返り）、海外研修（台湾）④", "", "2025/12/19", None),
    ("2025/12/21", "", "爽風館スクーリング（第２棟立入禁止）", "", "2025/12/21", None),
    ("2025/12/22", "", "職員会議（15:40-16:35, 大会議室）、編入試験（午前中）", "短縮・清掃カット", "2025/12/22", "短縮校時"),
    ("2025/12/23", "", "２年クラスマッチ", "", "2025/12/23", None),
    ("2025/12/24", "", "終業式、大掃除、第３回トイレサミット", "", "2025/12/24", None),
    ("2025/12/25", "", "3年共通テストプレⅡ（代ゼミ）①、（転入考査）", "", "2025/12/25", None),
    ("2025/12/26", "", "3年共通テストプレⅡ（代ゼミ）②", "", "2025/12/26", None),
    ("2025/12/29", "", "年末・年始の休業日", "", "2025/12/29", None),
    ("2025/12/30", "", "年末・年始の休業日", "", "2025/12/30", None),
    ("2025/12/31", "", "年末・年始の休業日", "", "2025/12/31", None)
]

print(f"Adding {len(daily_events)} daily events...")

for d in daily_events:
    # A:ID, B:Date, C:Time, D:Content, E:Note, F:EndDate, G:Order, H:ScheduleType
    # d = (Date, Time, Content, Note, EndDate, ScheduleType)
    row = [
        str(uuid.uuid4()), # ID
        d[0],              # Date
        d[1],              # Time
        d[2],              # Content
        d[3],              # Note
        d[4],              # EndDate
        999,               # Order
        d[5] if d[5] else "" # ScheduleType
    ]
    ws_daily.append(row)


# --- EVENT SHEET UPDATE ---
if 'イベント' not in wb.sheetnames:
    ws_event = wb.create_sheet('イベント')
    ws_event.append(['ID', 'Date', 'Content'])
else:
    ws_event = wb['イベント']

main_events = [
    ("2025/12/06", "修学旅行"),
    ("2025/12/07", "修学旅行"),
    ("2025/12/08", "修学旅行"),
    ("2025/12/09", "修学旅行"),
    ("2025/12/10", "修学旅行"),
    ("2025/12/11", "1年クラスマッチ"),
    ("2025/12/16", "海外研修"),
    ("2025/12/17", "海外研修"),
    ("2025/12/18", "海外研修"),
    ("2025/12/19", "海外研修"),
    ("2025/12/23", "2年クラスマッチ"),
    ("2025/12/24", "終業式"),
    ("2025/12/29", "年末・年始の休業日"),
    ("2025/12/30", "年末・年始の休業日"),
    ("2025/12/31", "年末・年始の休業日")
]

print(f"Adding {len(main_events)} main events...")

for m in main_events:
    row = [
        str(uuid.uuid4()),
        m[0],
        m[1]
    ]
    ws_event.append(row)

wb.save(file_path)
print("Done.")
