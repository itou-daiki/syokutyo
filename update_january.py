import openpyxl
import uuid

file_path = 'Database.xlsx'
wb = openpyxl.load_workbook(file_path)

# --- DAILY SHEET UPDATE ---
ws_daily = wb['行事']

daily_events = [
    ("2026/01/01", "", "元旦", "", "2026/01/01", None),
    ("2026/01/02", "", "年末・年始の休業日", "", "2026/01/02", None),
    ("2026/01/07", "", "第3回入試準備委員会（9:00-9:50）、運営委員会（10:30〜11:20）", "", "2026/01/07", None),
    ("2026/01/08", "", "始業式、大掃除、職員会議（13:30〜15:00）", "", "2026/01/08", None),
    ("2026/01/09", "", "課題・実力考査、共通テスト結団式", "", "2026/01/09", None),
    ("2026/01/12", "", "成人の日", "", "2026/01/12", None),
    ("2026/01/13", "", "課題・実力考査、第4回入試準備委員会（7限, 大会議室）", "", "2026/01/13", None),
    ("2026/01/14", "", "面接旬間（〜1/23）", "短縮", "2026/01/14", "短縮校時"),
    ("2026/01/15", "", "", "短縮", "2026/01/15", "短縮校時"),
    ("2026/01/16", "", "人権学習HRA（１年）", "短縮", "2026/01/16", "短縮校時"),
    ("2026/01/17", "", "共通テスト、ベネッセ総合学力テスト（1,2年）", "", "2026/01/17", None),
    ("2026/01/18", "", "共通テスト、ベネッセ総合学力テスト（2年）", "", "2026/01/18", None),
    ("2026/01/19", "", "共通テスト自己採点、第8回推薦委員会", "短縮", "2026/01/19", "短縮校時"),
    ("2026/01/20", "", "", "短縮", "2026/01/20", "短縮校時"),
    ("2026/01/21", "4限", "運委", "短縮", "2026/01/21", "短縮校時"),
    ("2026/01/22", "", "PTA役員会（15:00-17:00）", "短縮", "2026/01/22", "短縮校時"),
    ("2026/01/23", "", "主権者教育HRA（1,2年）、志望校検討会議第3回", "短縮", "2026/01/23", "短縮校時"),
    ("2026/01/27", "", "職員会議（15:45-16:35, 大会議室）", "短縮・清掃カット", "2026/01/27", "短縮校時"),
    ("2026/01/28", "", "【WS】学年発表会（1年全/5〜6限）", "", "2026/01/28", None),
    ("2026/01/30", "", "公開人権HRA（2年）、人権職員研修（対話会, 全職員）", "", "2026/01/30", None)
]

print(f"Adding {len(daily_events)} daily events...")

for d in daily_events:
    # A:ID, B:Date, C:Time, D:Content, E:Note, F:EndDate, G:Order, H:ScheduleType
    # d = (Date, Time, Content, Note, EndDate, ScheduleType)
    row = [
        str(uuid.uuid4()), # ID
        d[0],              # Date
        d[1],              # Time
        d[2],              # Content
        d[3],              # Note
        d[4],              # EndDate
        999,               # Order
        d[5] if d[5] else "" # ScheduleType
    ]
    ws_daily.append(row)


# --- EVENT SHEET UPDATE ---
if 'イベント' not in wb.sheetnames:
    ws_event = wb.create_sheet('イベント')
    ws_event.append(['ID', 'Date', 'Content'])
else:
    ws_event = wb['イベント']

main_events = [
    ("2026/01/01", "元旦"),
    ("2026/01/02", "年末・年始の休業日"),
    ("2026/01/08", "始業式"),
    ("2026/01/12", "成人の日"),
    ("2026/01/17", "共通テスト"),
    ("2026/01/18", "共通テスト")
]

print(f"Adding {len(main_events)} main events...")

for m in main_events:
    row = [
        str(uuid.uuid4()),
        m[0],
        m[1]
    ]
    ws_event.append(row)

wb.save(file_path)
print("Done.")
