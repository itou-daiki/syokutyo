import openpyxl
import uuid

file_path = 'Database.xlsx'
wb = openpyxl.load_workbook(file_path)

# --- DAILY SHEET UPDATE ---
ws_daily = wb['行事']

daily_events = [
    ("2026/03/01", "", "卒業式", "", "2026/03/01", None),
    ("2026/03/02", "", "振替休業（3/1分）", "", "2026/03/02", None),
    ("2026/03/04", "4限", "運委（4限）", "", "2026/03/04", None),
    ("2026/03/05", "正午", "評点入力完了（正午）", "", "2026/03/05", None),
    ("2026/03/06", "", "HRA（前期生徒会選挙）、拡大学年会議（15:45-16:35）", "", "2026/03/06", None),
    ("2026/03/09", "", "入試会場設営", "午後カット", "2026/03/09", "短縮校時"),
    ("2026/03/10", "", "一次入試（生徒は自宅学習）、検査日", "", "2026/03/10", None),
    ("2026/03/11", "", "一次入試（生徒は自宅学習）、採点", "", "2026/03/11", None),
    ("2026/03/12", "", "一次入試（生徒は自宅学習）、選考会議", "", "2026/03/12", None),
    ("2026/03/13", "", "HRA（）、運委（？限）、合格通知発送", "", "2026/03/13", None),
    ("2026/03/16", "", "【SSC】英語発表会（2年SS/5〜6限）、合格者説明会、（第二志願校出願（〜3/19））", "", "2026/03/16", None),
    ("2026/03/17", "", "1年県内最先端科学研修（次年度SS予定者）、（第二志願校出願（締切日））、（特例選抜B検査日）", "", "2026/03/17", None),
    ("2026/03/18", "", "1年県内最先端科学研修（次年度SS予定者）、（入試選考委員会（1限？）・職員会議（午後）、第2志願・特例選抜選考）", "午後カット？", "2026/03/18", "短縮校時"),
    ("2026/03/20", "", "春分の日", "", "2026/03/20", None),
    ("2026/03/24", "", "修了式、大掃除", "", "2026/03/24", None),
    ("2026/03/25", "", "諸表簿提出（〆切16時）、（転入考査）", "", "2026/03/25", None),
    ("2026/03/26", "", "運委（10:00-11:00）", "", "2026/03/26", None),
    ("2026/03/27", "", "職員会議（10:00-11:00, 大会議室）", "", "2026/03/27", None),
    ("2026/03/30", "", "離任式", "", "2026/03/30", None)
]

print(f"Adding {len(daily_events)} daily events...")

for d in daily_events:
    row = [
        str(uuid.uuid4()), # ID
        d[0],              # Date
        d[1],              # Time
        d[2],              # Content
        d[3],              # Note
        d[4],              # EndDate
        999,               # Order
        d[5] if d[5] else "" # ScheduleType
    ]
    ws_daily.append(row)


# --- EVENT SHEET UPDATE ---
if 'イベント' not in wb.sheetnames:
    ws_event = wb.create_sheet('イベント')
    ws_event.append(['ID', 'Date', 'Content'])
else:
    ws_event = wb['イベント']

main_events = [
    ("2026/03/01", "卒業式"),
    ("2026/03/10", "一次入試"),
    ("2026/03/11", "一次入試"),
    ("2026/03/12", "一次入試"),
    ("2026/03/20", "春分の日"),
    ("2026/03/24", "修了式"),
    ("2026/03/30", "離任式")
]

print(f"Adding {len(main_events)} main events...")

for m in main_events:
    row = [
        str(uuid.uuid4()),
        m[0],
        m[1]
    ]
    ws_event.append(row)

wb.save(file_path)
print("Done.")
